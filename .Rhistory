load("data_exercises/diet.Rdata")
sel <- complete.cases(X2) & complete.cases(X3)
X2.comp <- X2[sel,]
X3.comp <- X3[sel,]
XX <- cbind(X2, X3)[sel,]
mm2 <- ord(t(XX))
plotgenes(mm2, nlab = 2)
plotgenes(mm2, nlab = 2)
sel <- complete.cases(X2) & complete.cases(X3)
X2.comp <- X2[sel,]
X3.comp <- X3[sel,]
X <- list(nut=t(X2.comp), food=t(X3.comp))
mm <- mcia(X)
plot(mm, df.col=c("red", "blue"), gene.nlab = 2)
plotgenes(mm2, nlab = 2)
plotgenes(mm2, nlab = 2)
names(X3)
names(X1)
XX <- scale(XX)
mm2 <- ord(t(XX))
plotgenes(mm2, nlab = 2)
plotgenes(mm2, nlab = 4)
X2.comp <- sacale(X2[sel,])
X3.comp <- scale(X3[sel,])
X2.comp <- scale(X2[sel,])
X3.comp <- scale(X3[sel,])
X <- list(nut=t(X2.comp), food=t(X3.comp))
mm <- mcia(X)
plot(mm, df.col=c("red", "blue"), gene.nlab = 2)
library(abn)
setwd("c:/juan/CREAL/GitHub/biomarkers_multiple_tables/")
load("data_exercises/diet.Rdata")
names(X1)
X <- cbind(X1[, c("casoc", "estudios", "peso", "mets_10a", "Colesterol")],
X3)
X <- X[complete.cases(X),]
dim(X)
knitr::opts_chunk$set(echo = TRUE)
X.c <- X[complete.cases(X),]
names(X-c)
names(X.c)
X.c$casoc
?fitabn
max.par<-list(Colesterol=2,
gra_procmeat=2,
casoc=2)
mydag <- matrix(0, nrow=3, ncol = 3)
rownames(mydag) <- colnames(mydag) <- c("Colesterol", "gra_procmeat", "casoc")
mydat
mydag
mydag["Colesterol", "casoc"] <- 1
mydag["Colesterol", "gra_procmeat"] <- 1
mydat["gra_procmeat", "casoc"] <- 1
mydag["gra_procmeat", "casoc"] <- 1
mydag
model1 <- fitabn(dag.m=mydag, data.df = mydat, data.dists = mydists,
centre=0, create.graph = TRUE)
mydat <- X.c[, c("Colesterol", "gra_procmeat", "casoc")]
mydists <- list(Colesterol="gaussian",
gra_procmeat="gaussain",
casoc="binomial")
max.par<-list(Colesterol=2,
gra_procmeat=2,
casoc=2)
model1 <- fitabn(dag.m=mydag, data.df = mydat, data.dists = mydists,
centre=0, create.graph = TRUE)
mydists <- list(Colesterol="gaussian",
gra_procmeat="gaussian",
casoc="binomial")
model1 <- fitabn(dag.m=mydag, data.df = mydat, data.dists = mydists,
centre=0, create.graph = TRUE)
mydists <- list(Colesterol="binomial",
gra_procmeat="gaussian",
casoc="binomial")
max.par<-list(Colesterol=2,
gra_procmeat=2,
casoc=2)
mydag <- matrix(0, nrow=3, ncol = 3)
rownames(mydag) <- colnames(mydag) <- c("Colesterol", "gra_procmeat", "casoc")
mydag["Colesterol", "casoc"] <- 1
mydag["Colesterol", "gra_procmeat"] <- 1
mydag["gra_procmeat", "casoc"] <- 1
mydag
model1 <- fitabn(dag.m=mydag, data.df = mydat, data.dists = mydists,
centre=0, create.graph = TRUE)
model1
model1$mlik
plot(model1)
plot(model1$graph)
library(graph)
plot(model1$graph)
plot(model1$graph)
mydag["gra_procmeat", "Colesterol"] <- 1
mydag["casoc", "gra_procmeat"] <- 1
mydag
mydag <- matrix(0, nrow=3, ncol = 3)
rownames(mydag) <- colnames(mydag) <- c("Colesterol", "gra_procmeat", "casoc")
mydag <- matrix(0, nrow=3, ncol = 3)
rownames(mydag) <- colnames(mydag) <- c("Colesterol", "gra_procmeat", "casoc")
mydag
mydag["casoc", "Colesterol"] <- 1
mydag["gra_procmeat", "Colesterol"] <- 1
mydag["casoc", "gra_procmeat"] <- 1
mydag
model1 <- fitabn(dag.m=mydag, data.df = mydat, data.dists = mydists,
centre=0, create.graph = TRUE)
model1$mlik
plot(model1$graph)
model1 <- fitabn(dag.m=mydag, data.df = mydat, data.dists = mydists,
centre=TRUE, create.graph = TRUE)
model1$mlik
library(graph)
plot(model1$graph)
mydag0 <- matrix(0, nrow=3, ncol = 3)
rownames(mydag0) <- colnames(mydag0) <- c("Colesterol", "gra_procmeat", "casoc")
model0 <- fitabn(dag.m=mydag0, data.df = mydat, data.dists = mydists,
centre=TRUE, create.graph = TRUE)
model0$mlik
tographviz(dag.m=mydag, data.df=mydat, data.dists=mydists, outfile="graph.dot", directed=TRUE)
system("dot -Tpdf -o graph.pdf graph.dot")
myres.c<-fitabn(dag.m=mydag, data.df=mydat, data.dists=mydists, centre=TRUE,
compute.fixed=TRUE, n.grid=100)
plot(myres.c$graph)
ban <- retain <- matrix(0, nrow=ncol(mydat), ncol=ncol(mydat))
colnames(ban) <- rownames(ban) <- names(mydat)
colnames(retain) <- rownames(retain) <- names(mydat)
ban <- retain <- matrix(0, nrow=ncol(mydat), ncol=ncol(mydat))
pp <- "c:/juan/CREAL/GitHub/biomarkers_multiple_tables/"
load(file.path(pp, "data_exercises/diet.Rdata"))
X <- cbind(X1[, c("casoc", "estudios", "peso", "mets_10a", "Colesterol")],
X3)
dim(X)
X <- X[complete.cases(X),]
dim(X)
X.c <- X[complete.cases(X),]
mydat <- X.c[, c("Colesterol", "gra_procmeat", "casoc")]
mydists <- list(Colesterol="binomial",
gra_procmeat="gaussian",
casoc="binomial")
mydag <- matrix(0, nrow=3, ncol = 3)
rownames(mydag) <- colnames(mydag) <- c("Colesterol", "gra_procmeat", "casoc")
mydag
mydag["casoc", "Colesterol"] <- 1
mydag["gra_procmeat", "Colesterol"] <- 1
mydag["casoc", "gra_procmeat"] <- 1
mydag
model1 <- fitabn(dag.m=mydag, data.df = mydat, data.dists = mydists,
centre=TRUE, create.graph = TRUE)
model1$mlik
mydag0 <- matrix(0, nrow=3, ncol = 3)
rownames(mydag0) <- colnames(mydag0) <- c("Colesterol", "gra_procmeat", "casoc")
model0 <- fitabn(dag.m=mydag0, data.df = mydat, data.dists = mydists,
centre=TRUE, create.graph = TRUE)
model0$mlik
library(graph)
plot(model1$graph)
ban <- retain <- matrix(0, nrow=ncol(mydat), ncol=ncol(mydat))
colnames(ban) <- rownames(ban) <- names(mydat)
colnames(retain) <- rownames(retain) <- names(mydat)
max.par <- list(Colesterol="binomial",
gra_procmeat="gaussian",
casoc="binomial")
mycache<-buildscorecache(data.df=mydat, data.dists=mydists,
dag.banned=ban, dag.retained=retain,
max.parents = max.par)
install.packages("ggm")
library(ggm)
?DAG
plot(myres.c$graph)
names(X)
with(X, DAG(casoc~Colesterol, casoc~gra_fruit))
DAG(casoc~Colesterol, casoc~gra_fruit, data=X)
DAG(casoc~Colesterol, casoc~gra_fruit)
ls()
mydag <- ggm::DAG(casoc~Colesterol, casoc~gra_fruit)
fitDag(dd)
args(fitabn)
?fitabn
?mostprobable
?buildscorecache
mydat <- X.c[, c("Colesterol", "gra_procmeat", "casoc")]
mydists <- list(Colesterol="binomial",
gra_procmeat="gaussian",
casoc="binomial")
rownames(mydag) <- colnames(mydag) <- c("Colesterol", "gra_procmeat", "casoc")
mydag
mydag["casoc", "Colesterol"] <- 1
mydag["gra_procmeat", "Colesterol"] <- 1
mydag["casoc", "gra_procmeat"] <- 1
mydag
mydag
mydag <- matrix(0, nrow=3, ncol = 3)
rownames(mydag) <- colnames(mydag) <- c("Colesterol", "gra_procmeat", "casoc")
mydag
mydag["gra_procmeat", "Colesterol"] <- 1
mydag
mydag["casoc", "Colesterol"] <- 1
mydag["gra_procmeat", "Colesterol"] <- 1
mydag["casoc", "gra_procmeat"] <- 1
mydag
dim(X)
X <- cbind(X1, X2)
names(X)
X1$estudios
mydists <- list(rep("gaussian", ncol(X3)))
mydists
dd <- c("binomial", "binomial", "gaussian", "gaussian",
"binomial", "binomial", "binomial", rep("gaussian", ncol(X3)))
names(dd) <- c(vars1, names(X3))
vars1 <- c("casoc", "sexo", "peso", "mets_10a",
"Colesterol", "Diabetes", "Hipertension")
names(dd) <- c(vars1, names(X3))
mydists <- list(dd)
mydists
as.list(dd)
dd <- c("binomial", "binomial", "gaussian", "gaussian",
"binomial", "binomial", "binomial", rep("gaussian", ncol(X3)))
dd
names(dd) <- c(vars1, names(X3))
mydists <- as.list(dd)
ban <- retain <- matrix(0, nrow=ncol(mydat), ncol=ncol(mydat))
colnames(ban) <- rownames(ban) <- names(mydat)
colnames(retain) <- rownames(retain) <- names(mydat)
max.par <- list(Colesterol=2,
gra_procmeat=2,
casoc=2)
mycache<-buildscorecache(data.df=mydat, data.dists=mydists,
dag.banned=ban, dag.retained=retain,
max.parents = max.par)
mydists
names(mydists)
mydists <- list(Colesterol="binomial",
gra_procmeat="gaussian",
casoc="binomial")
mydists
mydata
mydat
names(mydat)
load(file.path(pp, "data_exercises/diet.Rdata"))
vars1 <- c("casoc", "sexo", "peso", "mets_10a",
"Colesterol", "Diabetes", "Hipertension")
X <- cbind(X1[, vars1],  X3)
names(X1)
vars1
load(file.path(pp, "data_exercises/diet.Rdata"))
vars1 <- c("casoc", "sexo", "peso", "mets_10a",
"Colesterol", "Diabetes", "Hipertensio")
X <- cbind(X1[, vars1],  X3)
mydat <- X[complete.cases(X),]
dd <- c("binomial", "binomial", "gaussian", "gaussian",
"binomial", "binomial", "binomial", rep("gaussian", ncol(X3)))
dd
names(dd) <- c(vars1, names(X3))
mydists <- as.list(dd)
mydists
ban <- retain <- matrix(0, nrow=ncol(mydat), ncol=ncol(mydat))
colnames(ban) <- rownames(ban) <- names(mydat)
colnames(retain) <- rownames(retain) <- names(mydat)
names(pp) <- names(mydat)
max.par <- as.list(pp)
pp <- rep(5, ncol(mydat))
names(pp) <- names(mydat)
max.par <- as.list(pp)
mycache<-buildscorecache(data.df=mydat, data.dists=mydists,
dag.banned=ban, dag.retained=retain,
max.parents = max.par)
mydat$Diabetes
load(file.path(pp, "data_exercises/diet.Rdata"))
vars1 <- c("casoc", "sexo", "peso", "mets_10a",
"Colesterol", "Hipertensio")
X <- cbind(X1[, vars1],  X3)
pp <- "c:/juan/CREAL/GitHub/biomarkers_multiple_tables/"
load(file.path(pp, "data_exercises/diet.Rdata"))
vars1 <- c("casoc", "sexo", "peso", "mets_10a",
"Colesterol", "Hipertensio")
X <- cbind(X1[, vars1],  X3)
mydat <- X[complete.cases(X),]
dd <- c("binomial", "binomial", "gaussian", "gaussian",
"binomial", "binomial", "binomial", rep("gaussian", ncol(X3)))
dd
names(dd) <- c(vars1, names(X3))
mydists <- as.list(dd)
mydists
ban <- retain <- matrix(0, nrow=ncol(mydat), ncol=ncol(mydat))
dd <- c("binomial", "binomial", "gaussian", "gaussian",
"binomial", "binomial", rep("gaussian", ncol(X3)))
dd
names(dd) <- c(vars1, names(X3))
mydists <- as.list(dd)
mydists
ban <- retain <- matrix(0, nrow=ncol(mydat), ncol=ncol(mydat))
colnames(ban) <- rownames(ban) <- names(mydat)
colnames(retain) <- rownames(retain) <- names(mydat)
ii <- rep(5, ncol(mydat))
names(pp) <- names(mydat)
names(ii) <- names(mydat)
max.par <- as.list(ii)
mycache<-buildscorecache(data.df=mydat, data.dists=mydists,
dag.banned=ban, dag.retained=retain,
max.parents = max.par)
load(file.path(pp, "data_exercises/diet.Rdata"))
vars1 <- c("casoc", "sexo", "peso", "mets_10a", "Colesterol")
X <- cbind(X1[, vars1],  X3)
mydat <- X[complete.cases(X),]
dd <- c("binomial", "binomial", "gaussian", "gaussian", "binomial",
rep("gaussian", ncol(X3)))
dd
names(dd) <- c(vars1, names(X3))
mydists <- as.list(dd)
mydists
ban <- retain <- matrix(0, nrow=ncol(mydat), ncol=ncol(mydat))
colnames(ban) <- rownames(ban) <- names(mydat)
colnames(retain) <- rownames(retain) <- names(mydat)
ii <- rep(5, ncol(mydat))
names(ii) <- names(mydat)
max.par <- as.list(ii)
mycache<-buildscorecache(data.df=mydat, data.dists=mydists,
dag.banned=ban, dag.retained=retain,
max.parents = max.par)
vars1 <- c("casoc", "sexo", "peso", "mets_10a", "Colesterol")
X <- cbind(X1[, vars1],  X3[,1:6])
mydat <- X[complete.cases(X),]
dd <- c("binomial", "binomial", "gaussian", "gaussian", "binomial",
rep("gaussian", ncol(X3)))
dd
names(dd) <- c(vars1, names(X3))
mydists <- as.list(dd)
mydists
ban <- retain <- matrix(0, nrow=ncol(mydat), ncol=ncol(mydat))
colnames(ban) <- rownames(ban) <- names(mydat)
colnames(retain) <- rownames(retain) <- names(mydat)
ii <- rep(5, ncol(mydat))
max.par <- as.list(ii)
names(ii) <- names(mydat)
mycache<-buildscorecache(data.df=mydat, data.dists=mydists,
dag.banned=ban, dag.retained=retain,
max.parents = max.par)
mydists
ban <- retain <- matrix(0, nrow=ncol(mydat), ncol=ncol(mydat))
colnames(ban) <- rownames(ban) <- names(mydat)
colnames(retain) <- rownames(retain) <- names(mydat)
ii <- rep(5, ncol(mydat))
names(ii) <- names(mydat)
max.par <- as.list(ii)
mycache<-buildscorecache(data.df=mydat, data.dists=mydists,
dag.banned=ban, dag.retained=retain,
max.parents = max.par)
mp.dag<-mostprobable(score.cache=mycache)
load(file.path(pp, "data_exercises/diet.Rdata"))
vars1 <- c("casoc", "sexo", "peso", "mets_10a", "Colesterol")
X <- cbind(X1[, vars1],  X3[,1:6])
mydat <- X[complete.cases(X),]
dd <- c("binomial", "binomial", "gaussian", "gaussian", "binomial",
rep("gaussian", ncol(X3)))
dd
names(dd) <- c(vars1, names(X3))
mydists <- as.list(dd)
mydists
ban <- retain <- matrix(0, nrow=ncol(mydat), ncol=ncol(mydat))
colnames(ban) <- rownames(ban) <- names(mydat)
colnames(retain) <- rownames(retain) <- names(mydat)
ii <- rep(5, ncol(mydat))
names(ii) <- names(mydat)
max.par <- as.list(ii)
mycache<-buildscorecache(data.df=mydat, data.dists=mydists,
dag.banned=ban, dag.retained=retain,
max.parents = max.par)
mydists
mydat
names(mydat)
dd <- c("binomial", "binomial", "gaussian", "gaussian", "binomial",
rep("gaussian", 6))
dd
names(dd) <- c(vars1, names(X3))
mydists <- as.list(dd)
mydists
colnames(ban) <- rownames(ban) <- names(mydat)
ban <- retain <- matrix(0, nrow=ncol(mydat), ncol=ncol(mydat))
colnames(retain) <- rownames(retain) <- names(mydat)
vars1 <- c("casoc", "sexo", "peso", "mets_10a", "Colesterol")
X <- cbind(X1[, vars1],  X3[,1:6])
mydat <- X[complete.cases(X),]
dd <- c("binomial", "binomial", "gaussian", "gaussian", "binomial",
rep("gaussian", 6))
dd
names(dd) <- c(vars1, names(X3))
mydists <- as.list(dd)
vars1 <- c("casoc", "sexo", "peso", "mets_10a", "Colesterol")
X <- cbind(X1[, vars1],  X3[,1:6])
mydat <- X[complete.cases(X),]
dd <- c("binomial", "binomial", "gaussian", "gaussian", "binomial",
rep("gaussian", 6))
dd
names(dd) <- c(vars1, names(X3)[1:6])
mydists <- as.list(dd)
mydists
ban <- retain <- matrix(0, nrow=ncol(mydat), ncol=ncol(mydat))
colnames(ban) <- rownames(ban) <- names(mydat)
colnames(retain) <- rownames(retain) <- names(mydat)
ii <- rep(5, ncol(mydat))
names(ii) <- names(mydat)
max.par <- as.list(ii)
mycache<-buildscorecache(data.df=mydat, data.dists=mydists,
dag.banned=ban, dag.retained=retain,
max.parents = max.par)
mp.dag<-mostprobable(score.cache=mycache)
mod.best <- fitabn(dag.m=mp.dag, data.df=mydat,
data.dists=mydists, create.graph=TRUE)
mod.best$mlik
plot(mod.best$graph)
names(mod3)
names(X3)
mydists <- list(Colesterol="binomial",
gra_procmeat="gaussian",
gra_oilolives="gaussian",
gra_vegetables="gaussian",
gra_wfish="gaussian",
casoc="binomial")
mydag <- ggm::DAG(Colesterol~casoc+gra_procmeat, gra_fruit~casoc+gra_vegetable,
gra_wfish)
mydag <- ggm::DAG(Colesterol~casoc+gra_procmeat, gra_fruit~casoc+gra_vegetable)
mydag <- ggm::DAG(Colesterol~casoc+gra_procmeat, gra_fruit~casoc+gra_vegetable,
gra_wfish~gra_oilolives)
mydag
plot(mydag)
model <- fitabn(dag.m=mydag, data.df = mydat, data.dists = mydists,
centre=TRUE, create.graph = TRUE)
names(mydat)
names(mydists)
mydat <- X.c[, c("Colesterol", "gra_procmeat", "gra_oilolives",
"gra_vegetables", "gra_wfish", "casoc")]
mydists <- list(Colesterol="binomial",
gra_procmeat="gaussian",
gra_oilolives="gaussian",
gra_vegetables="gaussian",
gra_wfish="gaussian",
casoc="binomial")
mydag <- ggm::DAG(Colesterol~casoc+gra_procmeat, gra_fruit~casoc+gra_vegetable,
gra_wfish~gra_oilolives)
mydag
model <- fitabn(dag.m=mydag, data.df = mydat, data.dists = mydists,
centre=TRUE, create.graph = TRUE)
mydag
dim(mydag)
dim(mydat)
names(mydat)
mydat <- X.c[, c("Colesterol", "gra_procmeat", "gra_oilolives",
"gra_vegetables", "gra_wfish", "gra_fruit", "casoc")]
mydists <- list(Colesterol="binomial",
gra_procmeat="gaussian",
gra_oilolives="gaussian",
gra_vegetables="gaussian",
gra_wfish="gaussian",
gra_fruit="gaussian"
casoc="binomial")
mydag <- ggm::DAG(Colesterol~casoc+gra_procmeat, gra_fruit~casoc+gra_vegetable,
gra_wfish~gra_oilolives)
mydists <- list(Colesterol="binomial",
gra_procmeat="gaussian",
gra_oilolives="gaussian",
gra_vegetables="gaussian",
gra_wfish="gaussian",
gra_fruit="gaussian",
casoc="binomial")
mydag <- ggm::DAG(Colesterol~casoc+gra_procmeat, gra_fruit~casoc+gra_vegetable,
gra_wfish~gra_oilolives)
mydag
model <- fitabn(dag.m=mydag, data.df = mydat, data.dists = mydists,
centre=TRUE, create.graph = TRUE)
pp <- "c:/juan/CREAL/GitHub/biomarkers_multiple_tables/"
plot(model$graph)
mydag <- ggm::DAG(Colesterol~casoc+gra_procmeat, gra_fruit~casoc+gra_vegetable,
gra_wfish~gra_oilolives+casoc, casoc~gra_procmeat)
mydag
model <- fitabn(dag.m=mydag, data.df = mydat, data.dists = mydists,
centre=TRUE, create.graph = TRUE)
plot(model$graph)
pp <- "c:/juan/CREAL/GitHub/biomarkers_multiple_tables/"
mydag <- ggm::DAG(Colesterol~casoc+gra_procmeat, gra_fruit~casoc+gra_vegetable,
gra_wfish~gra_oilolives+casoc, gra_promeat ~ casoc)
mydag
model <- fitabn(dag.m=mydag, data.df = mydat, data.dists = mydists,
centre=TRUE, create.graph = TRUE)
mydag <- ggm::DAG(Colesterol~casoc+gra_procmeat, gra_fruit~casoc+gra_vegetable,
gra_wfish~gra_oilolives+casoc, gra_procmeat ~ casoc)
mydag
model <- fitabn(dag.m=mydag, data.df = mydat, data.dists = mydists,
centre=TRUE, create.graph = TRUE)
plot(model$graph)
mydat <- X.c[, c("Colesterol", "gra_procmeat", "gra_oilolives",
"gra_vegetables", "gra_fruit", "casoc")]
mydists <- list(Colesterol="binomial",
gra_procmeat="gaussian",
gra_oilolives="gaussian",
gra_vegetables="gaussian",
gra_fruit="gaussian",
casoc="binomial")
mydag <- ggm::DAG(Colesterol~casoc+gra_procmeat, gra_fruit~casoc+gra_vegetable,
gra_oilolives ~ casoc, gra_procmeat ~ casoc)
mydag
model <- fitabn(dag.m=mydag, data.df = mydat, data.dists = mydists,
centre=TRUE, create.graph = TRUE)
plot(model$graph)
mydag <- ggm::DAG(Colesterol~casoc+gra_procmeat, gra_vegetable~casoc+gra_fruit,
gra_oilolives ~ casoc, gra_procmeat ~ casoc)
mydag
model <- fitabn(dag.m=mydag, data.df = mydat, data.dists = mydists,
centre=TRUE, create.graph = TRUE)
plot(model$graph)
pdf("c:/juan/CREAL/GitHub/biomarkers_multiple_tables/exercises/dag.pdf")
plot(model$graph)
dev.off()
